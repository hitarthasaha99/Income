@page "/dashboard/his/block_3"
@layout Income.Components.Layout.DashboardLayout
@inject NavigationManager NavigationManager
@inject IToastService toastService
@using FluentValidation
@using Income.Database.Models.Common
@using Income.Database.Models.HIS_2026
@using Income.Database.Models.SCH0_0
@using Income.Viewmodels
@using Microsoft.AspNetCore.Components.Forms
@using System.Text.RegularExpressions
@inject IJSRuntime JSRuntime
@inject ILoggingService loggingService
@inject Warning_VM warningVM
@inject IValidator<Tbl_Block_3> Validator

<div class="main-content">
    <!-- Header component showing selected FSU and survey time -->
    <CommonContentHeader SelectedFsuId="@SelectedFsuId" survey_time="@survey_time" />
    <ConfirmDialog @ref="dialog" />
    <div class="card custom-card">
        <!-- 🔹 Sticky Top Action Header -->
        <div class="card-header">
            <h3 class="card-title">
                <span class="text-primary me-2">[Block 3]</span>Demographic and other particulars of household members
            </h3>
            
            <div class="card-tools">
                <div class="d-flex align-items-center" hidden="@SessionStorage.FSU_Submitted">
                    @*  <button class="btn btn-outline-primary me-2" @onclick="@(() => Generate())">
                        <i class="fi fi-rr-settings me-1"></i>Generate
                    </button> *@
                    @if (SessionStorage.GetUserRole() == SessionStorage.UserRole.JSO)
                    {
                    <button class="btn btn-primary" @onclick="@(() => HandleModal("ADD"))">
                        <i class="fi fi-rr-plus me-1"></i>Add
                    </button>
                        
                    }
                </div>
                @* add comment *@
                @if (SessionStorage.GetUserRole() != SessionStorage.UserRole.JSO)
                {

                    <div class="card-tools">
                        <NavLink class="btn btn-primary" @onclick="@(() => Comment())"><i class="fi fi-rr-comment-alt me-2"></i>Comment</NavLink>
                    </div>
                }
            </div>
        </div>
        <!-- Scrollable table -->
        <div class="card-body p-0">
            <div class="table-responsive table-wrapper">
                <!-- Table displaying household members -->
                <table class="table table-striped table-bordered mb-0 fixed-column">
                    <thead>
                        <tr>
                            <th class="text-center col-1" rowspan="3">Action</th>
                            <th rowspan="3" class="text-center col-2">S.no.</th>
                            <th rowspan="3">Name of member</th>
                            <th rowspan="3">Relation to head(code)</th>
                            <th rowspan="3">Gender(code)</th>
                            <th rowspan="3">Age (years)</th>
                            <th rowspan="3">Marital status(code)</th>
                            <th rowspan="3">Highest educational level attained(code)</th>
                            <th class="text-center" colspan="4">Activity status</th>
                            <th rowspan="3" style="min-width:200px">Whether a beneficiary of any Central/State Government social assistance scheme as on date of survey(<i>yes-1/no-2</i>)</th>
                        </tr>
                        <tr>
                            <th class="text-center" colspan="2">During 30 days</th>
                            <th class="text-center" colspan="2">During 365 days</th>
                        </tr>
                        <tr>
                            <th>Primary(code)</th>
                            <th>Secondary(code)</th>
                            <th>Primary(code)</th>
                            <th>Secondary(code)</th>
                        </tr>
                        <tr>
                            <th class="col-1"></th>
                            <th class="text-center col-2">(1)</th>
                            <th>(2)</th>
                            <th>(3)</th>
                            <th>(4)</th>
                            <th>(5)</th>
                            <th>(6)</th>
                            <th>(7)</th>
                            <th>(8)</th>
                            <th>(9)</th>
                            <th>(10)</th>
                            <th>(11)</th>
                            <th>(12)</th>
                        </tr>
                    </thead>
                    @if (block3Members.Count != 0)
                    {
                        <tbody>
                            @foreach (var member in block3Members)
                            {
                                <tr>


                                    <td class="col-1">
                                        @if (SessionStorage.GetUserRole() == SessionStorage.UserRole.JSO)
                                        {
                                            <div class="d-flex align-items-center justify-content-center">
                                                <button class="btn btn-link me-3 fs-6"
                                                @onclick="@(() => HandleModal("UPDATE", member))">
                                                    <i class="fi fi-rr-pencil"></i>
                                                </button>
                                                @if (!(member.serial_no == 1 && member.item_3 == 1))
                                                {
                                                    
                                                <button class="btn btn-link fs-6 text-danger"
                                                @onclick="@(() => HandleDelete(member.id))">
                                                    <i class="fi fi-rr-trash"></i>
                                                </button>
                                                }
                                            </div>
                                        }

                                        </td>
                                    <td class="text-center col-2">@member.serial_no</td>
                                    <td>@member.item_2</td>
                                    <td>@member.item_3</td>
                                    <td>@member.gender</td>
                                    <td>@member.age</td>
                                    <td>@member.item_6</td>
                                    <td>@member.item_7</td>
                                    <td>@member.item_8</td>
                                    <td>@member.item_9</td>
                                    <td>@member.item_10</td>
                                    <td>@member.item_11</td>
                                    <td>
                                        @(member.item_12 == 1 ? "yes" : member.item_12 == 2 ? "no" : "")
                                    </td>
                                    
                                </tr>
                            }
                        </tbody>

                    }
                    else
                    {
                        <tbody>
                            <tr>
                                <td class="text-center" colspan="13">
                                    <div class="alert custom-alert alert-danger"><i class="fi fi-rr-triangle-warning me-2"></i> No Data Found</div>
                                </td>
                            </tr>
                        </tbody>
                    }
                </table>
            </div>
        </div>
    </div>
</div>
<!-- 🔹 Footer Navigation (Always visible) -->
<div class="footer">
    <!-- Remarks textarea -->
    <fieldset disabled="@(SessionStorage.GetUserRole() != SessionStorage.UserRole.JSO)">
        <div class="card custom-card">
            <div class="card-header">
                <h3 class="card-title">Remarks</h3>
            </div>
            <div class="card-body">
                <textarea maxlength="500" class="form-control" id="remarksTextarea" rows="2" placeholder="Enter remarks here.." @bind="block_1.block_3_remark" oninput="validateRemarks(event)"></textarea>
            </div>
        </div>
    </fieldset>
    <div class="row">
        <div class="col-sm-6">
            <div class="d-flex">
                <NavLink class="btn btn-outline-secondary" onclick="@GoBack">
                    <i class="fi fi-rr-angle-left me-1"></i>Back
                </NavLink>
            </div>
        </div>
        <div class="col-sm-6">
            <div class="d-flex align-items-center justify-content-end">
                <NavLink class="btn btn-primary" @onclick="@(() => HandleSubmit("NEXT"))">
                    Next<i class="fi fi-rr-angle-right ms-1"></i>
                </NavLink>
            </div>
        </div>
    </div>
</div>


<Modal @ref="AddModal" CloseOnEscape="false" UseStaticBackdrop="true" ShowCloseButton="false" Size="ModalSize.ExtraLarge" Fullscreen="ModalFullscreen.LargeDown">
    <HeaderTemplate>
        <h5 class="modal-title">@((isAdd ? "Add Member" : "Update Member"))</h5>
    </HeaderTemplate>
    <BodyTemplate>
        @if (editContext != null)
        {
            <EditForm EditContext="editContext">

                    <div class="row">

                        <!-- 1. Serial Number -->
                        <div class="col-sm-12">
                            <div class="mb-3">
                                <label class="form-label">
                                    <span class="form-badge">1</span> Sl no.
                                </label>
                                <input type="text" class="form-control" value="@newMember.serial_no" disabled />
                            </div>
                        </div>

                        <!-- 2. Name of Member input -->
                        <div class="col-sm-12">
                            <div class="mb-3">
                                <label class="form-label">
                                    <span class="form-badge">2</span> Name of Member
                                </label>

                                <InputText class="form-control"
                                           @bind-Value="newMember.item_2"
                                           placeholder="Enter Name of member"
                                           @oninput="ClearNameError"
                                           autocomplete="off"
                                           onbeforeinput="if (event.data && /[^A-Za-z ]/.test(event.data)) {event.preventDefault(); return false;}return validateText(event, this.value);"
                                           maxlength="50"
                                           autocorrect="off"
                                           autocapitalize="off"
                                           spellcheck="false" />
                                        <ValidationMessage For="@(() => newMember.item_2)" />
                            
                            </div>
                        </div>

                        <!-- 3. Relation to head -->
                        <div class="col-sm-12">
                            <div class="mb-3">
                                <label class="form-label">
                                    <span class="form-badge">3.</span> Relation to head (code)
                                </label>

                                <select class="form-select"
                                        value="@newMember.item_3"
                                        @onchange="item_3_changed">

                                <option value="">-Select-</option>
                                <option value="1">self - 1</option>
                                <option value="2">spouse of head - 2</option>
                                <option value="3">married child - 3</option>
                                <option value="4">spouse of married child - 4</option>
                                <option value="5">unmarried child - 5</option>
                                <option value="6">grandchild - 6</option>
                                <option value="7">father/mother/father-in-law/mother-in-law - 7</option>
                                <option value="8">brother/sister/brother-in-law/sister-in-law/other relatives - 8</option>
                                <option value="9">servants/employees/other non-relatives - 9</option>

                                </select>

                                <ValidationMessage For="@(() => newMember.item_3)" />
                            @if (!string.IsNullOrEmpty(spouceWarning))
                            {
                                <div class="form-text text-danger fw-bold">@spouceWarning</div>
                            }
                            </div>
                        </div>

                        <!-- 4. Gender -->
                        <div class="col-sm-12">
                            <div class="mb-3">
                                <label class="form-label">
                                    <span class="form-badge">4.</span> Gender (code)
                                </label>

                                <select class="form-select"
                                        value="@newMember.gender"
                                        @onchange="genderClear">

                                <option value="">-Select-</option>
                                <option value="1">male - 1</option>
                                <option value="2">female - 2</option>
                                <option value="3">transgender - 3</option>

                                </select>

                                <ValidationMessage For="@(() => newMember.gender)" />

                                @if (!string.IsNullOrEmpty(genderWarning))
                                {
                                    <div class="form-text text-success">@genderWarning</div>
                                }
                            </div>
                        </div>

                        <!-- 5. Age -->
                        <div class="col-sm-12">
                            <div class="mb-3">
                                <label class="form-label">
                                    <span class="form-badge">5</span> Age (years)
                                </label>

                            <InputNumber class="form-control no-spinner"
                                         inputmode="numeric"
                                         placeholder="Enter Your Age"
                                         pattern="[0-9]*"
                                         @bind-Value="newMember.age"
                                         @oninput="(e) => ageClear(e)"
                                         onbeforeinput="if (event.data && /[^0-9]/.test(event.data)) { event.preventDefault(); }"
                                         onkeypress="if(this.value.length >= 3) return false; return /^[0-9]$/.test(event.key);" />
                            <ValidationMessage For="@(() => newMember.age)" />

                                @if (!string.IsNullOrEmpty(ageWarning))
                                {
                                    <div class="text-success">@ageWarning</div>
                                }

                            @if (!string.IsNullOrEmpty(ageRelationWarning))
                            {
                                <div class="form-text text-success">@ageRelationWarning</div>
                            }
                            @if (!string.IsNullOrEmpty(singleUserWarning))
                            {
                                <div class="form-text text-success">@singleUserWarning</div>
                            }
                        </div>
                    </div>

                        <!-- 6. Marital status -->
                        <div class="col-sm-12">
                            <div class="mb-3">
                                <label class="form-label">
                                    <span class="form-badge">6</span> Marital status (code)
                                </label>

                                <select class="form-select"
                                        value="@newMember.item_6"
                                        @onchange="clearItem_6">

                                <option value="">-Select-</option>
                                <option value="1">never married – 1</option>
                                <option value="2">currently married (including living together) – 2</option>
                                <option value="3">widowed – 3</option>
                                <option value="4">divorced/separated – 4</option>

                                </select>

                                <ValidationMessage For="@(() => newMember.item_6)" />
                            @if (!string.IsNullOrEmpty(neverMarredWarn))
                            {
                                <div class="form-text text-danger fw-bold">@neverMarredWarn</div>
                            }

                                @if (!string.IsNullOrEmpty(maritalStatusWarning))
                                {
                                    <div class="form-text text-success">@maritalStatusWarning</div>
                                }
                            </div>
                        </div>

                        <!-- 7. Education -->
                        <div class="col-sm-12">
                            <div class="mb-3">
                                <label class="form-label">
                                    <span class="form-badge">7</span> Highest level of education
                                </label>

                                <select class="form-select"
                                        value="@newMember.item_7"
                                        @onchange="ClearItem7">

                                <option value="">-Select-</option>
                                <option value="1">not literate (i.e. not able to read or write a simple message with understanding in any language) - 01 </option>
                                <option value="2">literate without formal schooling (like NFEC, AEC, TLC, literate without any schooling, etc.) - 02 </option>
                                <option value="3">below primary - 03</option>
                                <option value="4">primary - 04</option>
                                <option value="5">upper primary/middle - 05</option>
                                <option value="6">secondary - 06</option>
                                <option value="7">higher secondary - 07</option>
                                <option value="8">diploma /certificate course - 08</option>
                                <option value="10">graduate - 10</option>
                                <option value="11">postgraduate and above - 11</option>

                                </select>

                                <ValidationMessage For="@(() => newMember.item_7)" />

                                @if (!string.IsNullOrEmpty(item_7Warning))
                                {
                                    <div class="form-text text-success">@item_7Warning</div>
                                }
                            </div>
                        </div>

                        <!-- Activity Status 30 days -->
                        <div class="col-sm-12">
                            <div class="card rounded-3 shadow-none border card-light-blue mb-3">
                                <div class="card-body">
                                    <h6 class="fw-bold">Activity status (During 30 days)</h6>
                                    <div class="row">
                                        <!-- Item 8 -->
                                        <div class="col-sm-12">
                                            <div class="mb-3">
                                                <label class="form-label">
                                                    <span class="form-badge">8</span> Primary
                                                </label>
                                                <CustomDropdown Value="@newMember.item_8"
                                                            ValueChanged="@(v => OnItem8Changed(v))"
                                                            Options="@ItemOptions" />
                                                <ValidationMessage For="@(() => newMember.item_8)" />

                                                @if (!string.IsNullOrEmpty(item_8Warning))
                                                {
                                                    <div class="form-text text-success">@item_8Warning</div>
                                                }
                                            </div>
                                        </div>

                                        <!-- Item 9 -->
                                        <div class="col-sm-12">
                                            <div>
                                                <label class="form-label">
                                                    <span class="form-badge">9</span> Secondary
                                                </label>
                                            @if (newMember.item_8 == 14 || newMember.item_8 == 15)
                                            {
                                                <select class="form-select" disabled>
                                                    <option>- Not Applicable -</option>
                                                </select>
                                            }
                                            else
                                            {
                                               
                                                <CustomDropdown Value="@newMember.item_9"
                                                            ValueChanged="@(v => OnItem9Changed(v))"
                                                            Options="@ItemOptions" />
                                            }

                                                <ValidationMessage For="@(() => newMember.item_9)" />

                                                @if (!string.IsNullOrEmpty(item_9Warning))
                                                {
                                                    <div class="form-text text-success">@item_9Warning</div>
                                                }
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <!-- Activity Status 365 days -->
                        <div class="col-sm-12">
                        <div class="card rounded-3 shadow-none border card-light-pink mb-3">
                                <div class="card-body">
                                    <h6 class="fw-bold">Activity status (During 365 days)</h6>
                                    <div class="row">
                                        <!-- Item 10 -->
                                        <div class="col-sm-12">
                                            <div class="mb-3">
                                                <label class="form-label">
                                                    <span class="form-badge">10</span> Primary
                                                </label>
                                                <CustomDropdown Value="@newMember.item_10"
                                                                ValueChanged="@(v => OnItem10Changed(v))"
                                                                Options="@ItemOptions" />

                                                <ValidationMessage For="@(() => newMember.item_10)" />

                                                @if (!string.IsNullOrEmpty(item_10Warning))
                                                {
                                                    <div class="form-text text-success">@item_10Warning</div>
                                                }
                                            </div>
                                        </div>

                                        <!-- Item 11 -->
                                        <div class="col-sm-12">
                                            <div>
                                                <label class="form-label">
                                                    <span class="form-badge">11</span> Secondary
                                                </label>
                                            @if (newMember.item_10 == 14 || newMember.item_10 == 15)
                                            {
                                                <select class="form-select" disabled>
                                                    <option>- Not Applicable -</option>
                                                </select>
                                            }
                                            else{
                                                <CustomDropdown Value="@newMember.item_11"
                                                            ValueChanged="@(v => OnItem11Changed(v))"
                                                            Options="@ItemOptions" />

                                            }
                                                
                                                <ValidationMessage For="@(() => newMember.item_11)" />

                                                @if (!string.IsNullOrEmpty(item_11Warning))
                                                {
                                                    <div class="form-text text-success">@item_11Warning</div>
                                                }                                          
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <!-- Item 12 -->
                        <div class="col-sm-12">
                            <div class="mb-3">
                                <label class="form-label">
                                    <span class="form-badge">12</span> Beneficiary of govt scheme (yes-1 / no-2)
                                </label>

                            <select class="form-select"
                                         value="@newMember.item_12"
                                         @onchange="ClearItem12">

                                    <option value="">-Select-</option>
                                    <option value="1">Yes - 01</option>
                                    <option value="2">No - 02</option>

                                </select>

                                <ValidationMessage For="@(() => newMember.item_12)" />
                            @if (!string.IsNullOrEmpty(item_12Warning))
                            {
                                <div class="form-text text-success">@item_12Warning</div>
                            }
                            </div>
                        </div>
              
                    </div>

            </EditForm>
        }
    </BodyTemplate>

    <FooterTemplate>
        <button class="btn btn-outline-secondary me-auto" @onclick="@(() => HandleModal("CLOSE"))">Close</button>
        <button type="submit" @onclick="@(() => HandleAddMember())" class="btn btn-primary" form="YourEditFormId">@((isAdd ? "Save" : "Update"))</button>
    </FooterTemplate>
</Modal>

<CommentModal @ref="commentModal"
              MemberList="memberList"
              QuestionList="Question"
              Block="3"/>

@code {
    int SelectedFsuId = SessionStorage.SelectedFSUId;
    private CommonConfig commonConfig = new CommonConfig();
    DateTime survey_time = DateTime.Now;
    Modal AddModal = default!;
    // List for holding household members data
    private List<Tbl_Block_3> block3Members = new();
    private Tbl_Block_3 newMember = new();
    private Tbl_Block_1? block_1 = new();
    Tbl_Sch_0_0_Block_7 hhd = new();
    private ConfirmDialog dialog = default!;
    private String? nameError = null;
    private string? relationError = null;
    // Errors and warnings for fields
    private string? genderError = null;
    private string? genderWarning = null;
    private string? spouceWarning = null;
    private string? neverMarredWarn = null;
    private string? ageError = null;
    private string? item_6Error = null;
    private string? item_7Error = null;
    private string? item_8Error = null;
    private string? item_9Error = null;
    private string? item_10Error = null;
    private string? item_11Error = null;
    private string? item_12Error = null;
    //Age Warning
    private string? ageWarning = null;
    private string? maritalStatusWarning = null;
    private string? item_7Warning = null;
    private string? item_8Warning = null;
    private string? item_9Warning = null;
    private string? ageRelationWarning = null;
    private string? singleUserWarning = null;
    private string? item_10Warning = null;
    private string? item_11Warning = null;
    private string item_12Warning = string.Empty;
    // Age flag
    // private bool isItem12Disabled = true;
    DBQueries DBQueries = new();
    CommonQueries commonQueries = new();
    bool isAdd = false;
    private string? remarks = string.Empty;
    List<string> Question = new List<string>();
    List<int> memberList = [];
    EditContext editContext;
    ValidationMessageStore messageStore;
    CommentModal commentModal = default!;

    async void Comment()
    {
        isAdd = true;
        await commentModal.Open();
    }



    async void GoBack()
    {
        NavigationManager.NavigateTo("/dashboard/his/block0_1");
        // await JSRuntime.InvokeVoidAsync("__handleGoBack");
        return;
    }

    protected override async Task OnInitializedAsync()
    {
        Tbl_Visited_Blocks vb = new Tbl_Visited_Blocks
        {
            block_uri = "/dashboard/his/block_3",
            block_title = "HIS Block 3",
            block_code = CommonEnum.his_block_3.ToString(),
        };
        hhd = await DBQueries.GetCurrentHHD(SessionStorage.SelectedFSUId, SessionStorage.selected_hhd_id);
        block_1 = await DBQueries.FetchSingleForFsuAndHhdAsync<Tbl_Block_1>() ?? new();
        await commonQueries.InsertVisitedBlock(vb);

        await LoadData();
        try
        {
            if (SessionStorage.GetUserRole() != SessionStorage.UserRole.JSO)
            {
                survey_time = block3Members
                                .OrderByDescending(x => x.survey_timestamp)
                                .Select(x => (DateTime?)x.survey_timestamp)
                                .FirstOrDefault().GetValueOrDefault();

            }
        }
        catch
        {

        }

        StateHasChanged();
    }

    private async Task LoadData()
    {
        block3Members = await DBQueries.Fetch_SCH_HIS_Block3(SessionStorage.selected_hhd_id);
        if (block3Members != null && block3Members.Count > 0)
        {
            block3Members = block3Members.OrderBy(x => x.serial_no).ToList();
        }
        for(int i=1; i<=block3Members.Count; i++)
        {
            memberList.Add(i);
        }
        for (var i = 1; i <= 12; i++)
        {
            Question.Add(i.ToString());
        }
        StateHasChanged();
    }

    bool error = false;

    private void genderClear(ChangeEventArgs e)
    {
        ClearGenderError();

        var value = e.Value?.ToString();

        if (string.IsNullOrEmpty(value))
            newMember.gender = null;
        else
            newMember.gender = int.Parse(value);
        CheckGenderWarning();
        StateHasChanged();

    }

    private void item_3_changed(ChangeEventArgs e)
    {
        ClearRelationError();
        //after change the item 3 value then clear item 6 error massage
        clearItem_6Error();
        var value = e.Value?.ToString();

        if (string.IsNullOrEmpty(value))
            newMember.item_3 = null;

        else
            newMember.item_3 = int.Parse(value);
        //check again if change Relation to head change
        CheckGenderWarning();
        checkAgeReletionWarning();
        //Call then clear error  if select any thing
        CheckSpouseMaritalWarning();  

        checkSingleUser();

    }

    private void ageClear(ChangeEventArgs e)
    {
        ClearAgeError();

        var value = e.Value?.ToString();

        // if (string.IsNullOrEmpty(value))
        //     newMember.age = null;
        // else
        //     newMember.age = int.Parse(value);
        if (string.IsNullOrEmpty(value))
        {
            newMember.age = null;

            // Clear all warnings that depend on age
            ageWarning = null;
            ageRelationWarning = null;
            singleUserWarning = null;
            maritalStatusWarning = null;
            item_7Warning = null;
            item_8Warning = null;
            item_9Warning = null;
            item_10Warning = null;
            item_11Warning = null;
            item_12Warning = string.Empty;

            StateHasChanged();
            return;
        }
        if (string.IsNullOrEmpty(value))
        {
            newMember.age = null;
            return;
        }
        // Remove everything except digits
        value = Regex.Replace(value, @"\D", "");
        if (value.Length > 3)
        {
            value = value.Substring(0, 3);
        }
        newMember.age = int.Parse(value);


        checkAgeWarning();           // Check age >= 120
        checkAgeReletionWarning();   // Check relation rule (age < head age)
        checkSingleUser();
        checkItem_6Warning();
        CheckItem7Warning();
        CheckItem8Warning();
        CheckItem9Warning();
        CheckItem10Warning();
        CheckItem11Warning();
        ClearItem12Error();
        CheckItem12Warning();
    }



    private void clearItem_6(ChangeEventArgs e)
    {
        clearItem_6Error();  // Clear previous error/warning

        var value = e.Value?.ToString();

        if (string.IsNullOrEmpty(value))
            newMember.item_6 = null;
        else
            newMember.item_6 = int.Parse(value);

        checkItem_6Warning();    // Rule: If item_6 != 1 → age >= 15
        CheckSpouseMaritalWarning();

        StateHasChanged();
    }

    private void ClearItem7(ChangeEventArgs e)
    {
        clearItem7Error();
        item_7Error = null;

        if (int.TryParse(e.Value?.ToString(), out int v))
            newMember.item_7 = v;
        else
            newMember.item_7 = null;

        CheckItem7Warning();
    }

    private void OnItem8Changed(int? value)
    {
        ClearItem8Error();
        item_8Error = null;
        newMember.item_8 = value;
        CheckItem8Warning();
        ClearItem9Error();
        if (value == 14 || value == 15)
        {
            newMember.item_9 = null;
            item_9Warning = null;
            ClearItem9Error();
        }
        StateHasChanged();

    }
    
    private void OnItem9Changed(int? value)
    {
        ClearItem9Error();
        item_9Error = null;
        newMember.item_9 = value;
        CheckItem9Warning();
        StateHasChanged();
    }
  
    private void OnItem10Changed(int? value)
    {
        ClearItem10Error();
        ClearItem11Error();
        item_10Error = null;
        newMember.item_10 = value;
        CheckItem10Warning();
        if (value == 14 || value == 15)
        {
            newMember.item_11 = null;
            item_11Warning = null;
            ClearItem11Error();

        }
        StateHasChanged();
    }

    private void OnItem11Changed(int? value)
    {
        ClearItem11Error();
        item_11Error = null;
        newMember.item_11 = value;
        CheckItem11Warning();
        StateHasChanged();
    }
    
    private void ClearItem12(ChangeEventArgs e)
    {
        // Clear validation error
        ClearItem12Error();
        item_12Error = null;

        // Parse user input
        if (int.TryParse(e.Value?.ToString(), out int v))
            newMember.item_12 = v;
        else
            newMember.item_12 = null;

        CheckItem12Warning();
        // Refresh UI
        StateHasChanged();
    }

    //Gender Warning..............................................

    private void CheckGenderWarning()
    {
        var head = block3Members.FirstOrDefault(m => m.item_3 == 1);
        var spouse = newMember;

        if (head != null && head.gender.HasValue)
        {
            if (spouse != null && spouse.item_3 == 2 && spouse.gender.HasValue && spouse.gender == head.gender)
            {
                genderWarning = "W005(ii): Please check the entries recorded against col. 4 and col. 3 corresponding to members recorded at Serial nos (col. 1) 1 & 2 ";
                StateHasChanged();
                return;
            }

        }

        genderWarning = null;
        StateHasChanged();
    }

    private void checkAgeWarning()
    {
        ageWarning = null;

        // Check if age has a value
        if (newMember.age.HasValue)
        {
            if (newMember.age.Value > 120)
            {
                ageWarning = "W006(i): Invalid Entry, Please check the entry.";
                StateHasChanged();
                return;
            }
        }

        // No issue → ensure warning is cleared
        ageWarning = null;
        StateHasChanged();
    }


    //Age Retetion Warning..............................

    private void checkAgeReletionWarning()
    {
        ageRelationWarning = null;

        var head = block3Members.FirstOrDefault(m => m.item_3 == 1);
        var spouse = block3Members.FirstOrDefault(m => m.item_3 == 2);

        if (newMember.age == null)
            return;

        int memberAge = newMember.age.Value;
        int? headAge = head?.age;
        int? spouseAge = spouse?.age;

        // Cannot check rules that require head age
        if (headAge == null)
            return;

        // -------------------------------------------------------------
        // RULE (ii): Relation = 3–6 → age < head age
        // -------------------------------------------------------------
        if (newMember.item_3 is 3 or 4 or 5 or 6)
        {
            if (memberAge > headAge.Value)
            {
                ageRelationWarning = "W006(ii): Please check the age (col. 5) & corresponding entry recorded against col. 3";
                StateHasChanged();
                return;
            }
        }

        // -------------------------------------------------------------
        // RULE (iii): Relation = 7 → age > head age
        // -------------------------------------------------------------
        if (newMember.item_3 == 7)
        {
            if (memberAge <= headAge.Value)
            {
                ageRelationWarning = "W006(iii): Please check the age (col. 5) & corresponding entry recorded against col. 3";
                StateHasChanged();
                return;
            }
        }

        // -------------------------------------------------------------
        // RULE (iv): Relation = 3–5 → age difference ≥ 15 yrs (Head & Spouse)
        // -------------------------------------------------------------
        if (newMember.item_3 is 3 or 4 or 5)
        {
            if (Math.Abs(memberAge - headAge.Value) < 15)
            {
                ageRelationWarning = "W006(iv): Please check the age (col. 5) & corresponding entry recorded against col. 3";
                StateHasChanged();
                return;
            }

            if (spouseAge != null && Math.Abs(memberAge - spouseAge.Value) < 15)
            {
                ageRelationWarning = "W006(iv): Please check the age (col. 5) & corresponding entry recorded against col. 3";
                StateHasChanged();
                return;
            }
        }

        // -------------------------------------------------------------
        // RULE (v): Relation = 6 → age difference ≥ 32 yrs (Head & Spouse)
        // -------------------------------------------------------------
        if (newMember.item_3 == 6)
        {
            if (Math.Abs(memberAge - headAge.Value) < 32)
            {
                ageRelationWarning = "W006(v): Please check the age (col. 5) & corresponding entry recorded against col. 3";
                StateHasChanged();
                return;
            }

            if (spouseAge != null && Math.Abs(memberAge - spouseAge.Value) < 32)
            {
                ageRelationWarning = "W006(v): Please check the age (col. 5) & corresponding entry recorded against col. 3";
                StateHasChanged();
                return;
            }
        }

        // -------------------------------------------------------------
        // RULE (vi): Relation = 7 → age difference ≥ 15 yrs (Head & Spouse)
        // -------------------------------------------------------------
        if (newMember.item_3 == 7)
        {
            if (Math.Abs(memberAge - headAge.Value) < 15)
            {
                ageRelationWarning = "W006(vi): Please check the age (col. 5) & corresponding entry recorded against col. 3";
                StateHasChanged();
                return;
            }

            if (spouseAge != null && Math.Abs(memberAge - spouseAge.Value) < 15)
            {
                ageRelationWarning = "W006(vi):Please check the age (col. 5) & corresponding entry recorded against col. 3";
                StateHasChanged();
                return;
            }

        }


        StateHasChanged();
    }

    //Check Single User..............................................................

    private void checkSingleUser()
    {
        singleUserWarning = null;

        // Count active members (not deleted)
        int activeCount = block3Members.Count(m => m.is_deleted != true);

        // If ADD mode, include current member
        if (isAdd)
            activeCount++;

        // Warning ONLY when exactly ONE member exists
        if (activeCount != 1)
            return;

        // That single member must be SELF (serial 1)
        if (newMember.item_3 != 1 || newMember.serial_no != 1)
            return;

        // Age rule
        if (newMember.age.HasValue && newMember.age.Value < 6)
        {
            singleUserWarning = "W006(vii): Please check the entry";
        }
    }


    //Marital status Warning..........................

    private void checkItem_6Warning()
    {
        maritalStatusWarning = null;

        if (newMember.item_6 == null || newMember.age == null)
            return;

        int maritalStatus = newMember.item_6.Value;
        int age = newMember.age.Value;

        // Rule: if marital-status != 1 → age must be >= 15
        if (maritalStatus != 1 && age < 15)
        {
            maritalStatusWarning = "W007(v): Please check the entries recorded against cols. 3 & 5";
        }

        StateHasChanged();
    }

    //Education warning............................................................

    private void CheckItem7Warning()
    {
        item_7Warning = null;
        int? age = newMember.age;
        int? edu = newMember.item_7;

        if (!age.HasValue || !edu.HasValue)
            return;

        if(age<=3 && edu > 1)
        {
            item_7Warning = "W008(ii): Please check the entries recorded against cols. 7 & 5";
            return;
        }
        // Rule iii: If 4 <= age <= 6, edu must be <= 3
        if (age >= 4 && age <= 6 && edu > 3)
        {
            item_7Warning = "W008(iii): Please check the entries recorded against Cols. 7 & 5";
            return;
        }

        // Rule iv: If 7 <= age <= 11, edu must be <= 4
        if (age >= 7 && age <= 11 && edu > 4)
        {
            item_7Warning = "W008(iv): Please check the entries recorded against Cols. 7 & 5";
            return;
        }

        // Rule v: edu = 5, age >= 12
        if (edu == 5 && age < 12)
        {
            item_7Warning = "W008(v): Please check the entries recorded against Cols. 7 & 5";
            return;
        }

        // Rule vi: edu = 6, age >= 14
        if (edu == 6 && age < 14)
        {
            item_7Warning = "W008(vi): Please check the entries recorded against Cols. 7 & 5";
            return;
        }

        // Rule vii: edu = 7, age >= 16
        if (edu == 7 && age < 16)
        {
            item_7Warning = "W008(vii): Please check the entries recorded against Cols. 7 & 5";
            return;
        }

        // Rule viii: edu = 8, age >= 14
        if (edu == 8 && age < 14)
        {
            item_7Warning = "W008(viii): Please check the entries recorded against Cols. 7 & 5";
            return;
        }

        // Rule ix: edu = 10, age >= 19
        if (edu == 10 && age < 19)
        {
            item_7Warning = "W008(ix): Please check the entries recorded against Cols. 7 & 5";
            return;
        }

        // Rule x: edu = 11, age >= 21
        if (edu == 11 && age < 21)
        {
            item_7Warning = "W008(x): Please check the entries recorded against Cols. 7 & 5";
            return;
        }
    }

    //Item 8 Warning...................................
    private void CheckItem8Warning()
    {
        item_8Warning = null; // Replace with your warning variable for column 8

        if (newMember.item_8 == null || newMember.age == null)
            return;

        int col8 = newMember.item_8.Value; // Column 8 code
        int age = newMember.age.Value;

        // Rule: codes 01, 02, 04, 05 in col. 8 must have age >= 10
        if ((col8 == 1 || col8 == 2 || col8 == 4 || col8 == 5) && age < 10)
        {
            item_8Warning = "W008(ii): Please recheck entries recorded against cols. 5 & 8";
        }

        StateHasChanged();
    }

    //Item9 Warning...............................
    private void CheckItem9Warning()
    {
        item_9Warning = null; // Replace with your warning variable name for column 9

        if (newMember.item_9 == null || newMember.age == null)
            return;

        int col9 = newMember.item_9.Value; // Column 9 code
        int age = newMember.age.Value;

        // Rule: codes 01, 02, 04, 05 in col. 9 must have age >= 10
        if ((col9 == 1 || col9 == 2 || col9 == 4 || col9 == 5) && age < 10)
        {
            item_9Warning = "W009(ii): Please recheck entries recorded against cols. 5 & 9.";
        }

        StateHasChanged();
    }
    //Item 10 Warning.....................
    private void CheckItem10Warning()
    {
        item_10Warning = null; // Your variable for column 10 warning

        if (newMember.item_10 == null || newMember.age == null)
            return;

        int col10 = newMember.item_10.Value;
        int age = newMember.age.Value;

        // Codes 01, 02, 04, 05 in col.10 require age >= 10
        if ((col10 == 1 || col10 == 2 || col10 == 4 || col10 == 5) && age < 10)
        {
            item_10Warning = "W010(ii): Please check the entries recorded against Cols. 10 & 5";
        }

        StateHasChanged();
    }

    //Item 11 Warning
    private void CheckItem11Warning()
    {
        item_11Warning = null; // Your variable for column 11 warning

        if (newMember.item_11 == null || newMember.age == null)
            return;

        int col11 = newMember.item_11.Value;
        int age = newMember.age.Value;

        // Codes 01, 02, 04, 05 in col.11 require age >= 10
        if ((col11 == 1 || col11 == 2 || col11 == 4 || col11 == 5) && age < 10)
        {
            item_11Warning = "W011(ii): Please check the entries recorded against Cols. 11 & 5";
        }

        StateHasChanged();
    }

    private void CheckItem12Warning()
    {
        item_12Warning = string.Empty;
        if (newMember.age < 15 && newMember.item_12.GetValueOrDefault() is 1)
        {
            item_12Warning = $"W012(i): Invalid entry, please recheck the entry";
        }
    }



    // Clear All Errors After Input Anything.................................
    private void ClearNameError()
    {
        editContext?.NotifyFieldChanged(
            FieldIdentifier.Create(() => newMember.item_2));
    }
    private void ClearRelationError()
    {
        editContext?.NotifyFieldChanged(
           FieldIdentifier.Create(() => newMember.item_3));
    }
    private void ClearGenderError()
    {
        editContext?.NotifyFieldChanged(
           FieldIdentifier.Create(() => newMember.gender));
    }
    private void ClearAgeError()
    {
        editContext?.NotifyFieldChanged(
           FieldIdentifier.Create(() => newMember.age));
    }
    private void clearItem_6Error()
    {
        editContext?.NotifyFieldChanged(
           FieldIdentifier.Create(() => newMember.item_6));
    }
    private void clearItem7Error()
    {
        editContext?.NotifyFieldChanged(
           FieldIdentifier.Create(() => newMember.item_7));
    }
    private void ClearItem8Error()
    {
        editContext?.NotifyFieldChanged(
           FieldIdentifier.Create(() => newMember.item_8));
    }
    private void ClearItem9Error()
    {
        editContext?.NotifyFieldChanged(
           FieldIdentifier.Create(() => newMember.item_9));
    }
    private void ClearItem10Error()
    {
        editContext?.NotifyFieldChanged(
           FieldIdentifier.Create(() => newMember.item_10));
    }
    private void ClearItem11Error()
    {
        editContext?.NotifyFieldChanged(
           FieldIdentifier.Create(() => newMember.item_11));
    }
    private void ClearItem12Error()
    {
        editContext?.NotifyFieldChanged(
           FieldIdentifier.Create(() => newMember.item_12));
    }

    private void clearErrors()
    {
        // Clear all previous errors before validation
        nameError = null;
        relationError = null;
        genderError = null;
        ageError = null;
        item_6Error = null;
        item_7Error = null;
        item_8Error = null;
        item_9Error = null;
        item_10Error = null;
        item_11Error = null;
        item_12Error = null;
        genderWarning = null;
        ageWarning = null;
        ageRelationWarning = null;
        singleUserWarning = null;
        maritalStatusWarning = null;
        item_7Warning = null;
        item_8Warning = null;
        item_9Warning = null;
        item_10Warning = null;
        item_11Warning = null;
        item_12Warning = null;
    }

    async Task HandleModal(string action = "", Tbl_Block_3? data = null)
    {
        try
        {
            clearErrors();
            if (action == "ADD")
            {
                isAdd = true;
                if (data == null)
                {
                    newMember = new();
                    newMember.serial_no = ReturnCurrentMemberSerialNumber();
                    newMember.id = Guid.NewGuid();
                    editContext = new EditContext(newMember);
                    messageStore = new ValidationMessageStore(editContext);
                    editContext.OnFieldChanged += EditContext_OnFieldChanged;
                }
                else
                {
                    newMember = data;
                }

                await AddModal.ShowAsync();
            }
            else if (action == "UPDATE")
            {
                isAdd = false;
                if (data != null)
                {
                    newMember = data.ShallowCopy();
                    editContext = new EditContext(newMember);
                    messageStore = new ValidationMessageStore(editContext);
                    editContext.OnFieldChanged += EditContext_OnFieldChanged;
                    showAllWarnings();
                    await AddModal.ShowAsync();
                }
            }
            else
            {
                await AddModal.HideAsync();
            }
        }
        catch (Exception ex)
        {
            Console.WriteLine(ex.Message);
        }
        // clearErrors();
        // after close
        // spouceWarning = null;
        // neverMarredWarn = null;

    }
    private void showAllWarnings()
    {
        CheckGenderWarning();
        checkAgeWarning();
        checkAgeReletionWarning();
        checkSingleUser();
        checkItem_6Warning();
        CheckItem7Warning();
        CheckItem8Warning();
        CheckItem9Warning();
        CheckItem10Warning();
        CheckItem11Warning();
        CheckItem12Warning();
        CheckSpouseMaritalWarning();
    }

    private void EditContext_OnFieldChanged(object? sender, FieldChangedEventArgs e)
    {
        // Clear validation messages for this specific field
        messageStore.Clear(e.FieldIdentifier);

        // Update validation state
        editContext.NotifyValidationStateChanged();
    }

    int ReturnCurrentMemberSerialNumber()
    {
        try
        {
            if (block3Members != null && block3Members.Count > 0)
            {
                return block3Members.Count + 1;
            }
            else
            {
                return 1;
            }
        }
        catch
        {
            return 1;
        }
    }

    async Task HandleDelete(Guid id)
    {
        var options = new ConfirmDialogOptions { IsVerticallyCentered = true };
        var confirmation = await dialog.ShowAsync(
            title: "Alert",
            message1: "Are you sure you want to delete?",
            confirmDialogOptions: options
        );
        if (!confirmation)
        {
            return;
        }

        int item_index = block3Members.FindIndex(l => l.id == id);
        if (item_index != -1)
        {
            block3Members[item_index].is_deleted = true;
            var deleted = await DBQueries.DeleteHISBlock3(id);
            if (deleted == 0)
            {
                toastService.ShowSuccess("Could not delete entry");
            }
            else
            {
                toastService.ShowSuccess("Entry deleted successfully!");
            }
            await ReorderSerialNumbers();
            await LoadData();
            checkSingleUser();

        }
        else
        {
            toastService.ShowError("Not Able to delete row, Please try again!");
            return;
        }
    }


    // Logic: Add member to List when form is submitted
    private async Task HandleAddMember()
    {
        spouceWarning = null;
        CheckSpouseMaritalWarning(); 
        // clearErrors();
        messageStore.Clear();
        var errors = Validator.Validate(newMember);
        foreach (var error in errors.Errors)
        {
            var fieldIdentifier = new FieldIdentifier(newMember, error.PropertyName);
            messageStore.Add(fieldIdentifier, error.ErrorMessage);
        }
        editContext.NotifyValidationStateChanged();
        if (!errors.IsValid)
        {

            toastService.ShowError("Please resolve pending errors");
            return;
        }
        // block if spouce then click save
        if (!string.IsNullOrEmpty(spouceWarning))
        {
            toastService.ShowError(spouceWarning); 
            warningVM.AddWarning(spouceWarning, "HIS", "3", "3", SessionStorage.selected_hhd_id, newMember.serial_no.GetValueOrDefault());
            return;  
        }
        if (!string.IsNullOrEmpty(neverMarredWarn))
        {
            toastService.ShowError(neverMarredWarn);
            warningVM.AddWarning(neverMarredWarn, "HIS", "3", "3", SessionStorage.selected_hhd_id, newMember.serial_no.GetValueOrDefault());
            return;  
        }

        CheckGenderWarning();
        checkAgeWarning();
        checkAgeReletionWarning();
        checkSingleUser();
        checkItem_6Warning();
        CheckItem7Warning();
        CheckItem8Warning();
        CheckItem9Warning();
        CheckItem10Warning();
        CheckItem11Warning();
        CheckItem12Warning();

        if(!string.IsNullOrEmpty(genderWarning))
        {
            warningVM.AddWarning(genderWarning, "HIS", "3", "4", SessionStorage.selected_hhd_id, newMember.serial_no.GetValueOrDefault());
        }
        if (!string.IsNullOrEmpty(ageWarning))
        {
            warningVM.AddWarning(ageWarning, "HIS", "3", "4", SessionStorage.selected_hhd_id, newMember.serial_no.GetValueOrDefault());
        }
        if (!string.IsNullOrEmpty(ageRelationWarning))
        {
            warningVM.AddWarning(ageRelationWarning, "HIS", "3", "5", SessionStorage.selected_hhd_id, newMember.serial_no.GetValueOrDefault());
        }
        if (!string.IsNullOrEmpty(singleUserWarning))
        {
            warningVM.AddWarning(singleUserWarning, "HIS", "3", "5", SessionStorage.selected_hhd_id, newMember.serial_no.GetValueOrDefault());
        }
        if (!string.IsNullOrEmpty(maritalStatusWarning))
        {
            warningVM.AddWarning(maritalStatusWarning, "HIS", "3", "6", SessionStorage.selected_hhd_id, newMember.serial_no.GetValueOrDefault());
        }
        if (!string.IsNullOrEmpty(item_7Warning))
        {
            warningVM.AddWarning(item_7Warning, "HIS", "3", "7", SessionStorage.selected_hhd_id, newMember.serial_no.GetValueOrDefault());
        }
        if (!string.IsNullOrEmpty(item_8Warning))
        {
            warningVM.AddWarning(item_8Warning, "HIS", "3", "8", SessionStorage.selected_hhd_id, newMember.serial_no.GetValueOrDefault());
        }
        if (!string.IsNullOrEmpty(item_9Warning))
        {
            warningVM.AddWarning(item_9Warning, "HIS", "3", "9", SessionStorage.selected_hhd_id, newMember.serial_no.GetValueOrDefault());
        }
        if (!string.IsNullOrEmpty(item_10Warning))
        {
            warningVM.AddWarning(item_10Warning, "HIS", "3", "10", SessionStorage.selected_hhd_id, newMember.serial_no.GetValueOrDefault());
        }
        if (!string.IsNullOrEmpty(item_11Warning))
        {
            warningVM.AddWarning(item_11Warning, "HIS", "3", "11", SessionStorage.selected_hhd_id, newMember.serial_no.GetValueOrDefault());
        }
        if (!string.IsNullOrEmpty(item_12Warning))
        {
            warningVM.AddWarning(item_12Warning, "HIS", "3", "12", SessionStorage.selected_hhd_id, newMember.serial_no.GetValueOrDefault());
        }
        await warningVM.SaveWarningAsync("HIS", "3", newMember.serial_no.GetValueOrDefault());

        await DBQueries.Save_SCH_HIS_Block3(newMember);
        toastService.ShowSuccess(isAdd ? "Member added successfully!" : "Member updated successfully!");
        await AddModal.HideAsync();
        await LoadData();
        checkSingleUser();
    }
    private async Task ReorderSerialNumbers()
    {
        // Get fresh list
        block3Members = await DBQueries.Fetch_SCH_HIS_Block3(SessionStorage.selected_hhd_id);

        // Sort by old serial no
        block3Members = block3Members
            .Where(x => x.is_deleted != true)
            .OrderBy(x => x.serial_no)
            .ToList();

        int newSerial = 1;

        foreach (var member in block3Members)
        {
            member.serial_no = newSerial;
            await DBQueries.Save_SCH_HIS_Block3(member);  // update in DB
            newSerial++;
        }
    }


    async void HandleSubmit(string action = "")
    {
        if (SessionStorage.GetUserRole() != SessionStorage.UserRole.JSO)
        {
            NavigationManager.NavigateTo("/dashboard/his/block_4_1");
            return;
        }

        if(block3Members.Count == 0)
        {
            toastService.ShowError("Please add a member before proceeding");
            return;
        }

        if (block_1 != null)
        {
            await DBQueries.SaveAsync<Tbl_Block_1>(block_1);
        }
        NavigationManager.NavigateTo("/dashboard/his/block_4_1");


    }
    //if self never marred then self add then shoing error 
    private void CheckSpouseMaritalWarning()
    {
        spouceWarning = null;
        neverMarredWarn = null;

        // Find existing spouse (item3 == 2, not current member if editing)
        var existingSpouse = block3Members
            .FirstOrDefault(m => m.item_3 == 2 &&
                               (newMember.id == Guid.Empty || m.id != newMember.id));

        // Scenario 1: Editing HEAD to never married, but spouse exists
        if (newMember.item_3 == 1 && newMember.item_6 == 1 && existingSpouse != null)
        {
            neverMarredWarn = "H004: Invalid Entry, Please check the entry " +
                           existingSpouse.serial_no;
            StateHasChanged();
            return;
        }

        // Scenario 2: Adding/Editing SPOUSE, but head is never married
        var head = block3Members.FirstOrDefault(m => m.item_3 == 1);
        if (newMember.item_3 == 2 && head?.item_6 == 1)
        {
            spouceWarning = "H004: Invalid Entry, Please check the entry";
            StateHasChanged();
            return;
        }

        StateHasChanged();
    }


    // Item 8,9,10,11 List
    private List<CustomDropdown.OptionItem> ItemOptions = new()
    {
        new CustomDropdown.OptionItem {Value = null, Text = "Select"},
        new CustomDropdown.OptionItem{ Value=1, Text="Self-employed in agriculture (own account worker/employer) - 01" },
        new CustomDropdown.OptionItem{ Value=2, Text="Self-employed in non- agriculture (own account worker/employer) – 02" },
        new CustomDropdown.OptionItem{ Value=3, Text="Unpaid family worker in agriculture or non-agriculture – 03" },
        new CustomDropdown.OptionItem{ Value=4, Text="Regular wage/ salary – 04" },
        new CustomDropdown.OptionItem{ Value=5, Text="Casual labour – 05" },
        new CustomDropdown.OptionItem{ Value=6, Text="Did not work but was seeking and/or available for work – 06" },
        new CustomDropdown.OptionItem{ Value=7, Text="Student / attended educational institution - 07" },
        new CustomDropdown.OptionItem{ Value=8, Text="Attended domestic duties only – 08" },
        new CustomDropdown.OptionItem{ Value=9, Text="Attended domestic duties and was also engaged in free collection of goods (vegetables, roots, firewood, cattle feed, etc.), sewing, tailoring, weaving, etc. for household use - 09" },
        new CustomDropdown.OptionItem{ Value=10, Text="Earning from rent – 10" },
        new CustomDropdown.OptionItem{ Value=11, Text="Earning from pensions -11" },
        new CustomDropdown.OptionItem{ Value=12, Text="Earning from remittances -12" },
        new CustomDropdown.OptionItem{ Value=13, Text="Earning from interest - 13" },
        new CustomDropdown.OptionItem{ Value=14, Text="Unfit for work due to disability or illness – 14" },
        new CustomDropdown.OptionItem{ Value=15, Text="Others (including children not attending school, begging, prostitution, etc.) – 15" },
    };
}


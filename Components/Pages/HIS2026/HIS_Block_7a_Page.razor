@page "/dashboard/his/block_7a"
@using Blazored.FluentValidation
@using Income.Common.HIS2026
@using Income.Database.Models.Common
@using Income.Database.Models.HIS_2026
@using Income.Validators.HIS2026
@using Income.Viewmodels
@inject IJSRuntime JSRuntime
@layout Income.Components.Layout.DashboardLayout
@inject NavigationManager NavigationManager
@inject IToastService toastService
@inject Comment_vm comment_vm
@inject LocalizationService Loc

<div class="pb-5">
    <CommonContentHeader/>
     @* 7.1 *@
    <div class="card card-style2 rounded-4">
        <div class="card-header d-flex align-items-center justify-content-between bg-transparent">
            <h5 class="card-title m-0">
                <span class="text-primary me-1">Block 7a:</span>
                 Income from Self-employment - Crop cultivation
            </h5>
            <div class="card-tools ms-auto">
                <button class="btn btn-primary" @onclick="OnShowModalClick"><i class="bi bi-plus me-1"></i>Add</button>
            </div>
        </div>
        <div class="row px-3 py-2">
            <div class="col">
                For Agricultural Establishment engaged in crop cultivation (includes production of cereals, pulses, oilseeds, cash-crops, vegetables, fruits, spices, flowers etc. <span class="text-primary">(entry against any one or more of S. nos. 1-2 of Q4.4 of Block 4 is selected)</span>
            </div>
        </div>
        <div class="card-body p-0">
            <div class="table-responsive">
                <table class="table table-bordered align-middle text-center mb-0">
                    <thead>
                        <tr>
                            <th colspan="10" class="bg-transparent text-start">
                                <label class="form-label fs-6 fw-bold m-0">
                                    <span class="badge bg-primary me-1 me-2">Q7.1 </span>
                                    Details of the crops cultivated by one or more member of the household during last 365 days?
                                </label>
                            </th>
                        </tr>
                        <tr>
                            <th style="width: 50px;">S. No.</th>
                            <th>Crop code (4 digits)</th>
                            <th>unit (Kg./no.)</th>
                            <th>Total Quantity Produced (harvested)</th>
                            <th>Total quantity sold (out of total production) </th>
                            <th>Total sale value(in Rs.)</th>
                            <th>Average per unit sale value (in Rs.)</th>
                            <th>Value of pre-harvested sale (Rs.)</th>
                            <th>Value of by-products (Rs.)</th>
                            <th>Action</th>
                        </tr>
                        <tr>
                            <th>(1)</th>
                            <th>(2)</th>
                            <th>(3)</th>
                            <th>(4)</th>
                            <th>(5)</th>
                            <th>(6)</th>
                            <th>(7)</th>
                            <th>(8)</th>
                            <th>(9)</th>
                            <th>(10)</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>1</td>
                            <td>1234</td>
                            <td>12</td>
                            <td>150</td>
                            <td>160</td>
                            <td>2345</td>
                            <td>100</td>
                            <td>100</td>
                            <td>100</td>
                            <td class="d-flex align-items-center justify-content-center">
                                <button class="btn btn-link me-2 text-muted d-flex align-items-center"><i class="bi bi-pencil"></i></button>
                                <button class="btn btn-link text-danger d-flex align-items-center"><i class="bi bi-trash3"></i></button>
                            </td>
                        </tr>
                        <tr>
                            <td>1</td>
                            <td>1234</td>
                            <td>12</td>
                            <td>150</td>
                            <td>160</td>
                            <td>2345</td>
                            <td>100</td>
                            <td>100</td>
                            <td>100</td>
                            <td class="d-flex align-items-center justify-content-center">
                                <button class="btn btn-link me-2 text-muted d-flex align-items-center"><i class="bi bi-pencil"></i></button>
                                <button class="btn btn-link text-danger d-flex align-items-center"><i class="bi bi-trash3"></i></button>
                            </td>
                        </tr>
                    </tbody>
                    <tfoot>
                        <tr>
                            <td>TOTAL</td>
                            <td>
                                <input class="form-control form-control-sm" disabled />
                            </td>
                            <td>
                                <input class="form-control form-control-sm" disabled />
                            </td>
                            <td>
                                <input class="form-control form-control-sm" disabled />
                            </td>
                            <td>
                                <input class="form-control form-control-sm" disabled />
                            </td>
                            <td></td>
                            <td>
                                <input class="form-control form-control-sm" disabled />
                            </td>
                            <td></td>
                            <td></td>
                            <td></td>
                        </tr>
                    </tfoot>
                </table>
            </div>
        </div>  
    </div>

     @* 7.2 *@
    <div class="card card-style2 rounded-4">
        <div class="card-body p-0">
            <div class="table-responsive">
                <table class="table table-bordered align-middle text-center mb-0">
                    <thead>
                        <tr>
                            <th colspan="3" class="bg-transparent text-start">
                                <label class="form-label fs-6 fw-bold m-0">
                                    <span class="badge bg-primary me-1">Q7.2</span>
                                    Expenses incurred by the household during ‘last 365 days’ on inputs used for production of crops (including imputed expenses)
                                </label>
                            </th>
                        </tr>
                        <tr>
                            <th style="width: 50px;">S. No.</th>
                            <th>Description of Item</th>
                            <th>Cost of Input (in Rs.)</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>1</td>
                            <td>Seeds </td>
                            <td>
                                <input class="form-control form-control-sm" onkeypress="return /^(\d*)$/.test(event.target.value + event.key)" />
                            </td>
                        </tr>
                        <tr>
                            <td>2</td>
                            <td>Manures, chemicals, bio-fertilizers, plant protection materials (chemicals/bio-pesticides) </td>
                            <td>
                                <input class="form-control form-control-sm" onkeypress="return /^(\d*)$/.test(event.target.value + event.key)" />
                            </td>
                        </tr>
                        <tr>
                            <td>3</td>
                            <td>Feed and fodder</td>
                            <td>
                                <input class="form-control form-control-sm" onkeypress="return /^(\d*)$/.test(event.target.value + event.key)" />
                            </td>
                        </tr>
                        <tr>
                            <td>4</td>
                            <td>Diesel, electricity and other fuel charges</td>
                            <td>
                                <input class="form-control form-control-sm" onkeypress="return /^(\d*)$/.test(event.target.value + event.key)" />
                            </td>
                        </tr>
                        <tr>
                            <td>5</td>
                            <td>Irrigation / water charges</td>
                            <td>
                                <input class="form-control form-control-sm" onkeypress="return /^(\d*)$/.test(event.target.value + event.key)" />
                            </td>
                        </tr>
                        <tr>
                            <td>6</td>
                            <td>Cost of hiring, repair and maintenance of machinery and equipment used for crop production </td>
                            <td>
                                <input class="form-control form-control-sm" onkeypress="return /^(\d*)$/.test(event.target.value + event.key)" />
                            </td>
                        </tr>
                        <tr>
                            <td>7</td>
                            <td>Labour cost (human and animal)</td>
                            <td>
                                <input class="form-control form-control-sm" onkeypress="return /^(\d*)$/.test(event.target.value + event.key)" />
                            </td>
                        </tr>
                        <tr>
                            <td>8</td>
                            <td>Lease rent for land used for crop production</td>
                            <td>
                                <input class="form-control form-control-sm" onkeypress="return /^(\d*)$/.test(event.target.value + event.key)" />
                            </td>
                        </tr>
                        <tr>
                            <td>9</td>
                            <td>Interest paid on loans utilized for the purpose of crop production and cost of crop insurance / premium </td>
                            <td>
                                <input class="form-control form-control-sm" onkeypress="return /^(\d*)$/.test(event.target.value + event.key)" />
                            </td>
                        </tr>
                        <tr>
                            <td>10</td>
                            <td>Transportation & packaging charges  </td>
                            <td>
                                <input class="form-control form-control-sm" onkeypress="return /^(\d*)$/.test(event.target.value + event.key)" />
                            </td>
                        </tr>
                        <tr>
                            <td>11</td>
                            <td>Storage charges (includes cold storage charges)</td>
                            <td>
                                <input class="form-control form-control-sm" onkeypress="return /^(\d*)$/.test(event.target.value + event.key)" />
                            </td>
                        </tr>
                        <tr>
                            <td>12</td>
                            <td>Others (include veterinary services etc.)</td>
                            <td>
                                <input class="form-control form-control-sm" onkeypress="return /^(\d*)$/.test(event.target.value + event.key)" />
                            </td>
                        </tr>
                        <tr>
                            <td>13</td>
                            <td class="fw-bold">Total (sum of entries at s. nos. 01-12)</td>
                            <td>
                                <input class="form-control form-control-sm" disabled />
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>

     @* 7.3, 7.4 .... *@
    <div class="card card-style2 rounded-4">
        <div class="card-body p-0">
            <div class="table-responsive">
                <table class="table table-bordered align-middle text-center mb-0">
                    <tbody>
                        <tr>
                            <td>
                                <div class="badge bg-primary me-1">Q7.3</div>
                            </td>
                            <td>Receipts from Sale of seeds/ manure / bio-fertilizer / saplings etc. during last 365 days (in whole no. of Rs.) </td>
                            <td>
                                <input class="form-control form-control-sm" onkeypress="return /^(\d*)$/.test(event.target.value + event.key)" />
                            </td>
                        </tr>
                        <tr>
                            <td>
                                <div class="badge bg-primary me-1">Q7.4</div>
                            </td>
                            <td>Sale value of produces which were cultivated beyond last 365 days but sold during last 365 days (in whole no. of Rs.) </td>
                            <td>
                                <input class="form-control form-control-sm" onkeypress="return /^(\d*)$/.test(event.target.value + event.key)" />
                            </td>
                        </tr>
                        <tr>
                            <td>
                                <div class="badge bg-primary me-1">Q7.5</div>
                            </td>
                            <td>Imputed value of crops consumed by the household or bartered to other households out of total production during last 365 days (in whole no. of Rs.) </td>
                            <td>
                                <input class="form-control form-control-sm" onkeypress="return /^(\d*)$/.test(event.target.value + event.key)" />
                            </td>
                        </tr>
                        <tr>
                            <td>
                                <div class="badge bg-primary me-1">Q7a.9</div>
                            </td>
                            <td>Gross Profit / Loss before tax realized by the establishment during last 365 days (in whole no. of Rs.) </td>
                            <td>
                                <input class="form-control form-control-sm" onkeypress="return /^(\d*)$/.test(event.target.value + event.key)" />
                                @* <div class="text-warning">warning text</div> *@
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    @* Remarks Card *@
    <div class="card card-style2 rounded-4">
        <div class="card-header">
            <h5 class="card-title m-0">
                Remarks
            </h5>
        </div>
        <div class="card-body">
            <textarea class="form-control w-100" rows="4"></textarea>
        </div>
    </div>

   
    <div class="row">
        <div class="col-sm-6">
            <button class="btn btn-outline-primary"><i class="bi bi-chevron-left me-1"></i>Back</button>
        </div>
        <div class="col-sm-6">
            <div class="d-flex align-items-center justify-content-end">
                <NavLink class="btn btn-primary me-2"><i class="bi bi-floppy-fill me-1"></i>Save</NavLink>
                <NavLink class="btn btn-outline-primary">Next<i class="bi bi-chevron-right ms-1"></i></NavLink>
            </div>
        </div>
        
    </div>

    <Modal @ref="modal" title="Add Details" IsVerticallyCentered="true">
        <BodyTemplate>
            <div class="row">
                <div class="col-sm-6">
                    <div class="form-group mb-3">
                        <label for="" class="form-label mb-2 d-flex align-items-start">
                            <span class="badge bg-primary me-1">1</span> S. No.
                        </label>
                        <input type="text" class="form-control form-control-sm" disabled>
                    </div>
                </div>
                <div class="col-sm-6">
                    <div class="form-group mb-3">
                        <label for="" class="form-label mb-2 d-flex align-items-start">
                            <span class="badge bg-primary me-1">2</span> Crop code (4 digits)
                        </label>
                        <select class="form-select form-select-sm">
                            <option>Please Select</option>
                        </select>
                    </div>
                </div>
                <div class="col-sm-6">
                    <div class="form-group mb-3">
                        <label for="" class="form-label mb-2 d-flex align-items-start">
                            <span class="badge bg-primary me-1">3</span> unit (Kg./no.)
                        </label>
                        <input type="text" class="form-control form-control-sm" onkeypress="return /^(\d*)$/.test(event.target.value + event.key)">
                    </div>
                </div>
                <div class="col-sm-6">
                    <div class="form-group mb-3">
                        <label for="" class="form-label mb-2 d-flex align-items-start">
                            <span class="badge bg-primary me-1">4</span> Total Quantity Produced (harvested)
                        </label>
                        <input type="text" class="form-control form-control-sm" onkeypress="return /^(\d*)$/.test(event.target.value + event.key)">
                    </div>
                </div>
                <div class="col-sm-6">
                    <div class="form-group mb-3">
                        <label for="" class="form-label mb-2 d-flex align-items-start">
                            <span class="badge bg-primary me-1">5</span> Total quantity sold (out of total production)
                        </label>
                        <input type="text" class="form-control form-control-sm" onkeypress="return /^(\d*)$/.test(event.target.value + event.key)">
                    </div>
                </div>
                <div class="col-sm-6">
                    <div class="form-group mb-3">
                        <label for="" class="form-label mb-2 d-flex align-items-start">
                            <span class="badge bg-primary me-1">6</span> Total sale value(in Rs.)
                        </label>
                        <input type="text" class="form-control form-control-sm" onkeypress="return /^(\d*)$/.test(event.target.value + event.key)">
                    </div>
                </div>
                <div class="col-sm-6">
                    <div class="form-group mb-3">
                        <label for="" class="form-label mb-2 d-flex align-items-start">
                            <span class="badge bg-primary me-1">7</span> Average per unit sale value (in Rs.)
                        </label>
                        <input type="text" class="form-control form-control-sm" onkeypress="return /^(\d*)$/.test(event.target.value + event.key)">
                    </div>
                </div>
                <div class="col-sm-6">
                    <div class="form-group mb-3">
                        <label for="" class="form-label mb-2 d-flex align-items-start">
                            <span class="badge bg-primary me-1">8</span> Value of pre-harvested sale (Rs.)
                        </label>
                        <input type="text" class="form-control form-control-sm" onkeypress="return /^(\d*)$/.test(event.target.value + event.key)">
                    </div>
                </div>
                <div class="col-sm-6">
                    <div class="form-group">
                        <label for="" class="form-label mb-2 d-flex align-items-start">
                            <span class="badge bg-primary me-1">9</span> Value of by-products (Rs.)
                        </label>
                        <input type="text" class="form-control form-control-sm" onkeypress="return /^(\d*)$/.test(event.target.value + event.key)">
                    </div>
                </div>
            </div>
        </BodyTemplate>
        <FooterTemplate>
            <Button class="btn btn-outline-primary" @onclick="OnHideModalClick">Close</Button>
            <Button class="btn btn-primary">Save changes</Button>
        </FooterTemplate>
    </Modal>
</div>


@code {
    private Modal modal = default!;

    private async Task OnShowModalClick()
    {
        await modal.ShowAsync();
    }

    private async Task OnHideModalClick()
    {
        await modal.HideAsync();
    }
}
